<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Greenbelt Step Club, Inc</title>
    <meta name="description" content="">
     <!-- Tell browser that the website is optimized for the phone -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"/>
    <link type="text/css" rel="stylesheet" href="css/custom.css"/>
    
     <!-- Material Icons -->
     <link href="css/local-gstatic.css" rel="stylesheet">
  </head>

  <body class="white">
    <nav class="navbar">
        <div class="nav-wrapper green darken-3">
            <a href="#" class="brand-logo center" id="navbar-title">Greenbelt Step Club</a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
              <li class="active"><a href="index.html">Home</a></li>
              <li class=""><a href="index.html">About</a></li>
              <li class=""><a href="index.html">Contact</a></li>
          </ul>
            <!-- this makes the navbar slide out for the phone -->
          <a href="#" data-target="slide-out" class="sidenav-trigger button-collapse right"><i class="material-icons black-text">menu</i></a>
        </div>
      </nav>
    
       <!-- this will appear on the phone navbar -->
      <ul id="slide-out" class="sidenav">
        <li class="active"><a href="index.html">Home</a></li>
        <li class=""><a href="index.html">About</a></li>
        <li class=""><a href="index.html">Contact</a></li>
      </ul>
    
      <main class="white">
    
       <div class="section">
        <table class="resposive-table" style="width:100vw;">
          <tr>
            <td>            
              <!-- https://materializecss.com/dropdown.html-->
              <a class="dropdown-trigger btn light-blue darken-4" href="#" data-target="dd_day">Day</a>
              <ul id="dd_day" class="dropdown-content">
                <li class="active"><a href="#!">All</a></li>
                <li><a href="#!">Monday</a></li>
                <li><a href="#!">Tuesday</a></li>
                <li><a href="#!">Wednesday</a></li>
                <li><a href="#!">Thursday</a></li>
                <li><a href="#!">Friday</a></li>
                <li><a href="#!">Saturday</a></li>
                <li><a href="#!">Sunday</a></li>
              </ul>
            </td>
            <td>Time</td> 
            <td>
              <!-- https://materializecss.com/dropdown.html-->
              <a class="dropdown-trigger btn light-blue darken-4" href="#" data-target="dd_fellowship">Type</a>
              <ul id="dd_fellowship" class="dropdown-content">
              <li class="active"><a href="#!">All</a></li>
              <li><a href="#!">AA</a></li>
              <li><a href="#!">ACA</a></li>
              <li><a href="#!">Al-Anon</a></li>
              <li><a href="#!">CDA</a></li>
              <li><a href="#!">DRA</a></li>
              <li><a href="#!">NA</a></li>
              <li><a href="#!">SAA</a></li>
              </ul>
            </td> 
            <td>Info</td>
            <td></td>
          </tr>

          <tbody id="meeting-schedule">
            
          </tbody>
        </table>
        </div>
    
      </main>
    
      <footer class="page-footer  green darken-3">
        <div class="container">
          <div class="row">
            <div class="col l6 s12">
              <h5 class="white-text"></h5>
              <p class="grey-text text-lighten-4"></p>
            </div>
            <div class="col l4 offset-l2 s12">
              <ul>
                <li><a href="index.html" class="white-text"></a></li>
                <li><a href="index.html" class="white-text"></a></li>
                <li><a href="index.html" class="white-text"></a></li>
              </ul>
            </div>
          </div>
        </div>
      </footer>
   
    <!--JavaScript at end of body for optimized loading-->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script type="text/javascript">


// it is too much trouble to  manually create html tables. just define them in javascript and let jquery code for you
class Day {
    constructor(name, list) {
        this.name = name; // it is too much trouble to manually type the day each time a Meeting class is created. add it once here. 
        this.list = list;
    }
}

class Meeting {
    constructor(time, fellowship, format, isClosed) {
        this.time = time;
        this.fellowship = fellowship;
        this.format = format;
        this.isClosed = isClosed;
    }
}

// warning: the fellow ship type (AA, NA, ect) must be the same here as it is in the dropdown bar in the table header. the javascript is doing string comparisons.
// be sure to use a variable rather than re-typing "AA" or the like when initializing Day classes. That way if something is wrong you only have to check two places. 
let FELLOWSHIP_AA = "AA";
let FELLOWSHIP_ACA = "ACA";
let FELLOWSHIP_AlANON = "Al-Anon";
let FELLOWSHIP_CDA = "CDA";
let FELLOWSHIP_DRA = "DRA";
let FELLOWSHIP_NA = "NA";
let FELLOWSHIP_SAA = "SAA";


let sunshineSobriety_meetingId = "919 226 699";
let sunshineSobriety_meetingPassword = "061035";
let sunshineSobriety_meetingLink = "https://zoom.us/j/919226699?pwd=WGI2VEpSb1VnSUtEUnF5azNFSkZ5QT09";

function SunshineSobrietyMeeting(meetingFormat)
{
  return {
      time: "6:45 AM",
      fellowship: FELLOWSHIP_AA,
      format: meetingFormat,
      isClosed: true,
      isVirtual: true,
      isInPerson: false,
      meetingId: sunshineSobriety_meetingId,
      password: sunshineSobriety_meetingPassword,
      link: sunshineSobriety_meetingLink,
    }
}


let monday = new Day("Monday", [
  SunshineSobrietyMeeting("Slogans"),
  {
    time: "10:00 AM",
    fellowship: FELLOWSHIP_AA,
    format: "As  Bill Sees It (last Mon. Sponsorhip)",
    isClosed: true,
  },
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Big Book",
    isClosed: true,
  },
  {
    time: "4:30 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Living Sober",
    isClosed: true,
  },
  {
    time: "6:30 PM",
    fellowship: FELLOWSHIP_DRA,
    format: "Monday Night & We're Alright",
    isClosed: false,
    isInPerson: true,
  },
]);

let tuesday = new Day("Tuesday", [
  SunshineSobrietyMeeting("Tools of Recovery"),
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_CDA,
    format: "Cellar Dwellers",
  },
  {
    time: "4:30 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Daily Reflections",
    isClosed: true
  },
  {
    time: "7:30 PM",
    fellowship: FELLOWSHIP_NA, 
    format: "A.W.O.L.",
  },
]);

let wednesday = new Day("Wednesday", [
  SunshineSobrietyMeeting("Big Book"),
  {
    time: "10:00 AM",
    fellowship: FELLOWSHIP_AA,
    format: "8th and 9th Steps (last Wed. AA Legacy)",
    isClosed: true,
  },
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_NA, 
    format: "Just For Today",
  },
  {
    time: "4:30 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Experience, Strength, and Hope",
    isClosed: true,
  },
  {
    time: "7:00 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Steps & Traditions Study Group",
  },
]);

let thursday = new Day("Thursday", [
  SunshineSobrietyMeeting("Steps & Traditions"),
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_NA, 
    format: "Not High at Noon",
  },
  {
    time: "4:30 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Grapevine",
  },
  {
    time: "6:30 PM",
    fellowship: FELLOWSHIP_AlANON,
    format: "Early Bird Serenity",
  },
  {
    time: "8:00 PM",
    fellowship: FELLOWSHIP_SAA,
    format: "Recovery in Action",
    isClosed: true
  },
]);

let friday = new Day("Friday", [
  SunshineSobrietyMeeting("How It Works"),
  {
    time: "10:00 AM",
    fellowship: FELLOWSHIP_AA,
    format: "Acceptance/Beginners",
    isClosed: true,
  },
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Acceptance",
    isClosed: true,
  },
  {
    time: "4:30 PM",
    fellowship: FELLOWSHIP_AA,
    format: "AA Literature",
    isClosed: true,
  },
  {
    time: "7:00 PM",
    fellowship: FELLOWSHIP_CDA,
    format: "Friday Happy Hour",
  },
]);

let saturday = new Day("Saturday", [
  SunshineSobrietyMeeting("Necessary for Life"),
  {
    time: "8:30 AM",
    fellowship: FELLOWSHIP_AA,
    format: "6th and 7th Steps",
    isClosed: true,
  },
  {
    time: "10:00 AM",
    fellowship: FELLOWSHIP_AA,
    format: "Beginners Step 123 Meeting",
    isClosed: true,
  },
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_ACA,
    format: "As We Grow",
    isClosed: true,
  },
  {
    time: "2:00 PM",
    fellowship: FELLOWSHIP_ACA,
    format: "ACA Workbook Study (2nd & 4th Saturdays",
    isClosed: true,
  },
  {
    time: "7:30 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Self Examination, Meditation, and Prayer",
  },
]);

let sunday = new Day("Sunday", [
  SunshineSobrietyMeeting("Came to Believe"),
  {
    time: "10:30 AM",
    fellowship: FELLOWSHIP_AA,
    format: "Tools of Recovery",
  },
  {
    time: "12:00 PM",
    fellowship: FELLOWSHIP_AA,
    format: "AA Literature",
  },
  {
    time: "6:00 PM",
    fellowship: FELLOWSHIP_CDA,
    format: "Sunday Fun Bunch"
  },
  {
    time: "8:00 PM",
    fellowship: FELLOWSHIP_AA,
    format: "Speaker Meeting",
  },
]);

function createMeetingInfo(meeting) {
  infoList = [meeting.format];
  if (meeting.isInPerson && meeting.isVirtual) {
    infoList.push("Held in person & virtually");
  } else if (meeting.isInPerson) {
    infoList.push("Held in person");
  } else if (meeting.isVirtual) {
    infoList.push("Held virtually");
  } else {
    infoList.push("Status unknown");
  }

  if (meeting.isVirtual) {
    infoList.push("Zoom Id: " + meeting.meetingId);
    infoList.push("Password: " + meeting.password);
    infoList.push(`<a href="${meeting.link}">Meeting Link</a>`);
  }

  var inner = $.map(infoList, x => 
  `<div>
   ${x}
   </div>
   `);

   joined = inner.join(`
   `);

  return `
  <div class="flex fdc">
    ${joined}
  </div>
  `;
}

function createRowsForDay(day) {
    rows = "";
    $.each(day.list, function(index, meeting) {
      let isClosed = "";
      if (meeting.isClosed) {
        isClosed = `(C)`;
      } else {
        isClosed = "(O)";
      }
    rows +=  `
        <tr class="${meeting.fellowship} ${day.name}">
            <td>${day.name.substr(0,3)}</td>
            <td>${meeting.time}</td>
            <td>${meeting.fellowship}</td>
            <td>${createMeetingInfo(meeting)}</td>
            <td>${isClosed}</td>
        </tr>
        `
    });

   return rows;
}

//     https://learn.jquery.com/using-jquery-core/document-ready/
$(document).ready(function(){

  //      https://materializecss.com/dropdown.html  
  M.AutoInit();
  $('.sidenav').sidenav();
  
  // the point of this is to use the "active" class to determine what needs to be displayed. the table header has two dropdowns. when a dropdown item is selected, 
  // it is marked as active, and the text in that dropdown is compared to  the table rows. if a table row has a matching class, it gets displayed. 
  $("ul.dropdown-content li").on("click",function() {
    let parent = $(this).parent();
    let children = parent.children();
    $.each(children, function(index, child) {
      $(this).removeClass("active");
    });

    $(this).toggleClass("active");
    
    let day = $("#dd_day");
    let fellowship = $("#dd_fellowship");
    let table = $("#meeting-schedule").children();

    let activeDay = "All";
    let activeFellowship = "All";
    $.each(day.children(), (idx, elem) => {
      if ($(elem).hasClass("active")){
        activeDay = $(this).text();
      }
    });

    $.each(fellowship.children(), (idx, elem) => {
      if ($(elem).hasClass("active")){
        activeFellowship = $(this).text();
      }
    });

    // show them all. makes the logic easier
    $.each(table, (idx, elem) => {
      $(elem).show();
    });

    $.each(table, (idx, elem) => {
      if (activeDay != "All" && !$(elem).hasClass(activeDay)) {
        $(elem).hide();
      }

      if (activeFellowship != "All" && !$(elem).hasClass(activeFellowship)) {
        $(elem).hide();
      }
    });
  });

    $("#meeting-schedule").append(createRowsForDay(monday));
    $("#meeting-schedule").append(createRowsForDay(tuesday));
    $("#meeting-schedule").append(createRowsForDay(wednesday));
    $("#meeting-schedule").append(createRowsForDay(thursday));
    $("#meeting-schedule").append(createRowsForDay(friday));
    $("#meeting-schedule").append(createRowsForDay(saturday));
    $("#meeting-schedule").append(createRowsForDay(sunday));
});
    </script>
  </body>
</html>